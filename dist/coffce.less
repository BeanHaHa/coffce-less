/*!
 * Coffce-Less
 * 一个模块化的Less基础类库，包含栅格系统、原子类、常用class和浏览器兼容等模块
 * import此less后，手动调用init方法来生成你需要的模块
 */

// 启动所有模块，模块参数保持默认
// 不建议使用
.init-all() {
    .init-grid();
    .init-margin();
    .init-padding();
    .init-common();
}

/*
 * 生成栅格化系统，参数：
 * @count: 栅格数，
 * @padding: 栅格左右padding
 * @width: container宽度，设为百分比则为响应式布局
 */
.init-grid(@count: 12, @padding: 15px, @width: 100%) {
    .cf-column {
        float: left;
        padding-left: @padding;
        padding-right: @padding;
        min-height: 1px;
        .box-sizing(border-box);
    }
    
    .cf-container {
        padding-left: @padding;
        padding-right: @padding;
        width: @width;
    }
    
    .cf-row {
        margin-left: -@padding;
        margin-right: -@padding;
        *zoom: 1;
        &:before, &:after {
            content: " "; 
            display: table; 
            line-height: 0;
        }
        &:after {
            clear: both;
        }
    }
    
    // 递归生成栅格
    .build-column(@i) when (@i > 0) {
        .build-column((@i - 1));
        .cf-column-@{count} {
            &:extend(.cf-column);
            width: percentage(@i / @count);
        }
        .cf-column-offset-@{count} {
            margin-left: percentage(@i / @count);
        }
    }

    .build-column(@count);
}

/*
 * 生成一定范围的margin原子类，参数：
 * @min: 最小值
 * @max: 最大值
 * @space: 间距
 */
.init-margin(@min: 0, @max: 100, @space: 5) {
    // 递归生成margin
    .build-margin(@count) when (@count >= @min) {
        .build-margin((@count - @space));
        
        .cf-mt-@{count} {
            margin-top: @count * 1px;
        }
        .cf-mb-@{count} {
            margin-bottom: @count * 1px;
        }
        .cf-mtb-@{count} {
            margin-top: @count * 1px;
            margin-bottom: @count * 1px;
        }
        
        .cf-ml-@{count} {
            margin-left: @count * 1px;
        }
        .cf-mr-@{count} {
            margin-right: @count * 1px;
        }
        .cf-mlr-@{count} {
            margin-left: @count * 1px;
            margin-right: @count * 1px;
        }
        
        .cf-ma-@{count} {
            margin: @count * 1px;
        }
    }
    
    .build-margin(@max);
}

/*
 * 生成一定范围的padding原子类，参数：
 * @min: 最小值
 * @max: 最大值
 * @space: 间距
 */
.init-padding(@min: 0, @max: 100, @space: 5) {
    // 递归生成padding
    .build-padding(@count) when (@count >= @min) {
        .build-padding((@count - @space));

        .cf-pt-@{count} {
            padding-top: @count * 1px;
        }
        .cf-pb-@{count} {
            padding-bottom: @count * 1px;
        }
        .cf-ptb-@{count} {
            padding-top: @count * 1px;
            padding-bottom: @count * 1px;
        }

        .cf-pl-@{count} {
            padding-left: @count * 1px;
        }
        .cf-pr-@{count} {
            padding-right: @count * 1px;
        }
        .cf-plr-@{count} {
            padding-left: @count * 1px;
            padding-right: @count * 1px;
        }

        .cf-pa-@{count} {
            padding: @count * 1px;
        }
    }

    .build-padding(@max);
}

/*
 * 生成常用class，参数：
 * @pre: 前缀
 */
.init-common(@pre: cf) {
    .@{pre}-clearfix {
        *zoom: 1;
        &:before, &:after {
            content: " "; 
            display: table; 
            line-height: 0;
        }
        &:after {
            clear: both;
        }
    }
    // 超出长度的文本显示省略号
    .@{pre}-truncate {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    // 配合父元素的overflow: hidden，可以实现多栏等高
    // 3000不够可以自己调大
    .@{pre}-high {
        margin-bottom: -3000px;
        padding-bottom: 3000px
    }
    .@{pre}-hide {
        display: none;
    }
    .@{pre}-circle {
        border-radius: 50%;
    }
    .@{pre}-oh {
        overflow: hidden;
    }
    .@{pre}-fl {
        float: left;
    }
    .@{pre}-fr {
        float: right;
    }
    .@{pre}-tac {
        text-align: center;
    }
    .@{pre}-tar {
        text-align: right;
    }
    .@{pre}-tal {
        text-align: left;
    }
    .@{pre}-width-full {
        width: 100%;
    }
    .@{pre}-height-full {
        height: 100%;
    }
}

// -----------------------------------------------
// 浏览器兼容mixin，不建议使用
// 建议使用autoprefixer等自动化工具完成
// -----------------------------------------------
.box-sizing(@box-model) {
    -webkit-box-sizing: @box-model;
    -moz-box-sizing: @box-model;
    box-sizing: @box-model;
}

.text-shadow(@shadow) {
    -webkit-text-shadow: @shadow;
    text-shadow: @shadow;
}

.box-shadow(@shadow) {
    -webkit-box-shadow: @shadow;
    box-shadow: @shadow;
}

.animation(@animation) {
    -webkit-animation: @animation;
    animation: @animation;
}

.transition(@transition) {
    -webkit-transition: @transition;
    -moz-transition: @transition;
    -o-transition: @transition;
    transition: @transition;
}

.transition-delay(@transition-delay) {
    -webkit-transition-delay: @transition-delay;
    -moz-transition-delay: @transition-delay;
    -o-transition-delay: @transition-delay;
    transition-delay: @transition-delay;
}

.transition-duration(@transition-duration) {
    -webkit-transition-duration: @transition-duration;
    -moz-transition-duration: @transition-duration;
    -o-transition-duration: @transition-duration;
    transition-duration: @transition-duration;
}

.transform(@transform) {
    -webkit-transform: @transform;
    -moz-transform: @transform;
    -ms-transform: @transform;
    -o-transform: @transform;
    transform: @transform;
}

.transform-origin(@origin) {
    -webkit-transform-origin: @origin;
    transform-origin: @origin;
}

.user-select(@select) {
    -webkit-user-select: @select;
    -moz-user-select: @select;
    -ms-user-select: @select;
    -o-user-select: @select;
    user-select: @select;
}

.opacity(@opacity) {
    opacity: @opacity;
    //IE
    @opacity-ie: @opacity * 100;
    -ms-filter: ~"alpha(opacity=@{opacity-ie})";
}

.placeholder(@color) {
    &:-moz-placeholder {
        color: @color;
    } // Firefox 4-18
    &::-moz-placeholder {
        color: @color;
    } // Firefox 19+
    &:-ms-input-placeholder {
        color: @color;
    } // Internet Explorer 10+
    &::-webkit-input-placeholder {
        color: @color;
    } // Safari and Chrome
}

.rgba (@r, @g ,@b, @a) {
    background-color: rgba(@r, @g, @b, @a);
    //IE
    @color: argb(rgba(@r, @g, @b, @a));
    -ms-filter: ~'"progid:DXImageTransform.Microsoft.gradient(startColorstr=@{color}, endColorstr=@{color})"';
}

.rgba(@r, @g, @b, @a, false) {
    background-color: rgb(@r, @g, @b);
    background-color: rgba(@r, @g, @b, @a);
}